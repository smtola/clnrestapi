openapi: 3.0.0
info:
  title: CLN REST API
  version: "1.5"

# ---------------- Security Schemes ----------------
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    User:
      type: object
      properties:
        username:
          type: string
        email:
          type: string
        password:
          type: string
    
    Category:
      type: object
      properties:
        _id:
          type: string
          description: MongoDB ObjectId as string
          example: "507f1f77bcf86cd799439011"
        name:
          type: string
          example: "Logistics"
        created_by:
          type: string
          description: User ID who created the category
          example: "user123"
    
    CategoryResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Category fetching successful!"
        data:
          type: array
          items:
            $ref: '#/components/schemas/Category'
    
    CategorySingleResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Category fetched successfully!"
        data:
          $ref: '#/components/schemas/Category'
    
    CategoryCreateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Category created successfully!"
        data:
          $ref: '#/components/schemas/Category'
    
    CategoryUpdateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Category updated successfully!"
        data:
          $ref: '#/components/schemas/Category'
    
    CategoryDeleteResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Category deleted successfully!"
    
    CategoryErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Category not found"

    Product:
      type: object
      properties:
        _id:
          type: string
          description: MongoDB ObjectId as string
          example: "507f1f77bcf86cd799439011"
        key:
          type: string
          description: Unique product key/identifier
          example: "rice"
        category:
          type: string
          description: Product category name
          example: "Export"
        product:
          type: string
          description: Product name
          example: "Rice"
        caption:
          type: string
          description: Product caption/description
          example: "Cambodia - France, Germany, Philippines and China"
        image:
          type: array
          items:
            type: string
          description: Array of image URLs/paths
          example: ["assets/image/products/rice/rice.jpg"]
        created_by:
          type: string
          description: User ID who created the product
          example: "user123"
    
    ProductResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Products fetched successfully!"
        data:
          type: array
          items:
            $ref: '#/components/schemas/Product'
    
    ProductSingleResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Product fetched successfully!"
        data:
          $ref: '#/components/schemas/Product'
    
    ProductCreateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Product created successfully!"
        data:
          $ref: '#/components/schemas/Product'
    
    ProductUpdateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Product updated successfully!"
        data:
          $ref: '#/components/schemas/Product'
    
    ProductDeleteResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Product deleted successfully!"
    
    ProductErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Product not found"

    RequestQuote:
      type: object
      properties:
            msg:
              type: string
            data:
              type: object
              properties:
                company_name:
                  type: string
                full_name:
                  type: string
                email:
                  type: string
                address:
                  type: string
                tel:
                  type: string
                job:
                  type: string
                origin_destination:
                  type: string
                product_name:
                  type: string
                weight_dimensions:
                  type: string
                service:
                  type: string
                container_size:
                  type: string
        
    ResendOtp:
      type: object
      properties:
        msg:
          type: string
          example: "OTP resend successfully"
        otp_expire: 
          type: string
          format: date-time
          example: 2025-09-04T10:15:30Z

    VerifyEmail:
      type: object
      properties:
        msg:
          type: string
          example: "Email verified successfully."
        user:
          type: object
          properties:
            _id:
              type: object
              properties:
                $oid:
                  type: string
                  example: "68b8d7763be2f8b63b9a4202"
            username:
              type: string
              example: "Itadmin"
            email:
              type: string
              format: email
              example: "itadmin@gmail.com"
            password_hash:
              type: string
              description: "Hashed password (scrypt)"
              example: "scrypt:32768:8:1$JXbflkDEB0BUumCW$b0ebb34a539c0f7a320..."
            role:
              type: string
              enum: [USER, ADMIN]
              example: "USER"
            is_verified:
              type: boolean
              example: false
            requires_otp:
              type: boolean
              example: false
            public_ip:
              type: string
              example: "0000.000.000"
            local_ip:
              type: string
              example: "Unknown"
            device_info:
              type: object
              properties:
                browser:
                  type: string
                  example: "Mobile Safari 18.6"
                os:
                  type: string
                  example: "iOS 18.6"
                device:
                  type: string
                  example: "iPhone"
            location:
              type: object
              properties:
                city:
                  type: string
                  example: "Phnom Penh"
                region:
                  type: string
                  example: "Phnom Penh"
                country:
                  type: string
                  example: "Cambodia"
                latitude:
                  type: number
                  format: float
                  example: 11.4483
                longitude:
                  type: number
                  format: float
                  example: 104.9133
            created_at:
              type: object
              properties:
                $date:
                  type: string
                  format: date-time
                  example: "2025-09-03T23:04:06.548Z"
            otp_expire:
              type: object
              properties:
                $date:
                  type: string
                  format: date-time
                  example: "2025-09-04T03:24:14.255Z"

    SEO:
      type: object
      properties:
        page:
          type: string
          example: home
        title:
          type: string
          example: CLN | Home
        description:
          type: string
          example: CLN Cambodia provides international and domestic logistics services.
        keywords:
          type: string
          example: CLN Cambodia, logistics, transportation, sea freight, air freight
        ogTitle:
          type: string
          example: CLN Cambodia
        ogDescription:
          type: string
          example: Offering international and domestic logistics services with 20 years of experience.
        ogImage:
          type: string
          example: https://cln-tan.vercel.app/og-home.png
        url:
          type: string
          example: https://cln-tan.vercel.app/home

    QuoteResult:
      type: object
      properties:
        price:
          type: number
          example: 1234.56
        eta:
          type: string
          example: "1-2 days"
        currency:
          type: string
          example: "USD"
        breakdown:
          type: object
          example:
            base_price: 1000
            weight_cost: 200
            fuel_surcharge: 20
            handling_fee: 14
            subtotal: 1214
            total: 1234

    QuoteDocument:
      type: object
      properties:
        _id:
          type: string
          example: "653f1b8e7a1c2d3f456789ab"
        origin:
          type: string
          example: "Port of Singapore"
        destination:
          type: string
          example: "Port of Shanghai"
        distance_km:
          type: number
          example: 3200
        chargeable_weight:
          type: number
          example: 22000
        containerMaxWeight:
          type: number
          example: 22000
        containerQuantity:
          type: integer
          example: 1
        containerSize:
          type: string
          example: "20' Dry"
        equipmentType:
          type: string
          example: "Dry Van"
        soc:
          type: boolean
          example: false
        commodity:
          type: string
          example: "Electronics"
        vesselDeparture:
          type: string
          example: "Vessel ABC123"
        departure_date:
          type: string
          format: date
          example: "2025-12-30"
        shipment_type:
          type: string
          example: "parcel"
        mode:
          type: string
          example: "sea"
        country:
          type: string
          example: "KH"
        quotes:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/QuoteResult'
        created_at:
          type: string
          format: date-time
          example: "2025-12-25T10:00:00Z"
        converted:
          type: boolean
          example: false
          
    RateCard:
      type: object
      properties:
        _id:
          type: string
        country:
          type: string
        mode:
          type: string
        local:
          type: string
        service:
          type: string
        docs:
          type: number
        trucking:
          type: number
        freight:
          type: number
        othc:
          type: number
        currency:
          type: string
        active:
          type: boolean

    RateCardInput:
      type: object
      required:
        - country
        - mode
        - service
      properties:
        country:
          type: string
        local:
          type: string
        mode:
          type: string
        docs:
          type: number
        trucking:
          type: number
        freight:
          type: number
        othc:
          type: number
        currency:
          type: string
        remark:
          type: string

    Commodity:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier (MongoDB ObjectId)
          example: "64f8c3a1b3e7a12d34f9c901"
        name:
          type: string
          description: Commodity name
          example: "Rice"
        description:
          type: string
          description: Optional description
          example: "High-quality Cambodian rice for export"
        code:
          type: string
          description: HS code or commodity code
          example: "10061000"
        created_by:
          type: string
          description: User ID who created the commodity
          example: "user123"
        created_at:
          type: string
          format: date-time
          example: "2025-12-24T10:15:30Z"
        active:
          type: boolean
          example: true

    CommodityResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Commodities fetched successfully!"
        data:
          type: array
          items:
            $ref: '#/components/schemas/Commodity'

    CommoditySingleResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Commodity fetched successfully!"
        data:
          $ref: '#/components/schemas/Commodity'

    CommodityCreateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Commodity created successfully!"
        data:
          $ref: '#/components/schemas/Commodity'

    CommodityUpdateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Commodity updated successfully!"
        data:
          $ref: '#/components/schemas/Commodity'

    CommodityDeleteResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Commodity deleted successfully!"

    CommodityErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Commodity not found"

    Port:
      type: object
      properties:
        id:
          type: string
          example: "64bfc8c9f0a5e5c1a0c5d2f1"
        name:
          type: string
          example: "Port of Singapore"
        code:
          type: string
          example: "SGSIN"
        country:
          type: string
          example: "Singapore"
        city:
          type: string
          example: "Singapore"
        type:
          type: string
          description: Type of port (sea, river, airport, unknown)
          example: "sea"
        lat:
          type: number
          format: float
          example: 1.264
        lon:
          type: number
          format: float
          example: 103.820

    PortCreate:
      type: object
      required:
        - name
        - country
        - lat
        - lon
      properties:
        name:
          type: string
          example: "Port of Singapore"
        code:
          type: string
          example: "SGSIN"
        country:
          type: string
          example: "Singapore"
        city:
          type: string
          example: "Singapore"
        type:
          type: string
          example: "sea"
        lat:
          type: number
          example: 1.264
        lon:
          type: number
          example: 103.820

    PortUpdate:
      type: object
      properties:
        name:
          type: string
        code:
          type: string
        country:
          type: string
        city:
          type: string
        type:
          type: string
        lat:
          type: number
        lon:
          type: number

    PortResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: '#/components/schemas/Port'

    SuccessMessage:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Port updated successfully"

    Error:
      type: object
      properties:
        error:
          type: string
          example: Page not found

paths:
  /api/v1/docs/auth/signup:
    post:
      summary: User sign up
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '201':
          description: Signup successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                  msg:
                    type: string

  /api/v1/docs/auth/login:
    post:
      summary: User login
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    application/json:
                      schema:
                        type: object
                        properties:
                          status:
                            type: boolean
                          access_token:
                            type: string
                          msg:
                            type: string
                          requiresOtp:
                            type: boolean
                            description: Indicates if OTP verification is required
                          username:
                            type: string
                            description: The logged-in username (for OTP page)

  /api/v1/docs/auth/refresh:
    post:
      summary: Refresh access token
      tags: [Auth]
      security:
        - bearerAuth: []   # Requires refresh token
      responses:
        '200':
          description: New access token
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string

  /api/v1/docs/auth/logout:
    post:
      summary: Logout user
      tags: [Auth]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logout successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  msg:
                    type: string

  /api/v1/docs/auth/verify-email:
    post:
      summary: VerifyEmail OTP
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                otp:
                  type: string
      responses:
        '200':
          description: Email verified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerifyEmail'
                
  /api/v1/docs/auth/verify-otp:
    post:
      summary: Login -> Verify OTP
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                otp:
                  type: string
      responses:
        '200':
          description: OTP verified successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                  msg:
                    type: string
                    example: OTP verified successfully
                  access_token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  refresh_token:
                    type: string
                    example: dGhpc2lzYXJlZnJlc2h0b2tlbg==
                  user:
                    type: object
                    properties:
                      username:
                        type: string
                        example: johndoe
                      email:
                        type: string
                        example: johndoe@example.com
                      role:
                        type: string
                        example: user

  /api/v1/docs/auth/resend-otp:
    post:
      summary: Resend OTP
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: OTP verified successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResendOtp'                   

  /api/v1/docs/auth/users:
    get:
      summary: Get Users (protected)
      tags: [Auth]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of users
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    _id:
                      type: string
                    username:
                      type: string
                    email:
                      type: string
                    role:
                      type: string
                    is_verified:
                      type: boolean

  /api/v1/docs/web/request-quote:
    post:
      summary: Request a Quote
      tags: [Web]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                company_name:
                  type: string
                full_name:
                  type: string
                email:
                  type: string
                address:
                  type: string
                tel:
                  type: string
                job:
                  type: string
                origin_destination:
                  type: string
                product_name:
                  type: string
                weight_dimensions:
                  type: string
                service:
                  type: string
                container_size:
                  type: string
      responses:
        '200':
          description: Email verified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RequestQuote'

  /api/v1/docs/web/contact-us:
    post:
      summary: Contact Us
      tags: [Web]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                company_name:
                  type: string
                full_name:
                  type: string
                email:
                  type: string
                address:
                  type: string
                tel:
                  type: string
                job:
                  type: string
                origin_destination:
                  type: string
                product_name:
                  type: string
                weight_dimensions:
                  type: string
                service:
                  type: string
                container_size:
                  type: string
      responses:
        '200':
          description: Email verified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RequestQuote'

  /api/v1/docs/web/categories:
    get:
      summary: Get all categories
      description: Retrieve a list of all categories (protected endpoint)
      tags: [Web]
      responses:
        '200':
          description: List of categories retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
    
    post:
      summary: Create a new category
      description: Create a new category (protected endpoint)
      tags: [Web]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Category name
                  example: "Logistics"
      responses:
        '201':
          description: Category created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryCreateResponse'
        '400':
          description: Bad request - Category name is required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '409':
          description: Conflict - Category with this name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'

  /api/v1/docs/web/categories/{category_id}:
    get:
      summary: Get a category by ID
      description: Retrieve a single category by its ID (protected endpoint)
      tags: [Web]
      parameters:
        - in: path
          name: category_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the category
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Category retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategorySingleResponse'
        '400':
          description: Bad request - Invalid category ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
    
    put:
      summary: Update a category
      description: Update an existing category by ID (protected endpoint)
      tags: [Web]
      parameters:
        - in: path
          name: category_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the category
          example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Updated category name
                  example: "Updated Logistics"
      responses:
        '200':
          description: Category updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryUpdateResponse'
        '400':
          description: Bad request - Invalid ID format or missing name
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '409':
          description: Conflict - Category with this name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
    
    delete:
      summary: Delete a category
      description: Delete a category by ID (protected endpoint)
      tags: [Web]
      parameters:
        - in: path
          name: category_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the category
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Category deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryDeleteResponse'
        '400':
          description: Bad request - Invalid category ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryErrorResponse'

  /api/v1/docs/web/products:
    get:
      summary: Get all products
      description: Retrieve a list of all products with optional category filter (protected endpoint)
      tags: [Web]
      parameters:
        - in: query
          name: category
          schema:
            type: string
          required: false
          description: Filter products by category name
          example: "Export"
      responses:
        '200':
          description: List of products retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
    
    post:
      summary: Create a new product
      description: Create a new product (protected endpoint)
      tags: [Web]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - key
                - category
                - product
                - caption
                - image
              properties:
                key:
                  type: string
                  description: Unique product key/identifier
                  example: "rice"
                category:
                  type: string
                  description: Product category name (must exist in categories)
                  example: "Export"
                product:
                  type: string
                  description: Product name
                  example: "Rice"
                caption:
                  type: string
                  description: Product caption/description
                  example: "Cambodia - France, Germany, Philippines and China"
                image:
                  type: array
                  items:
                    type: string
                  description: Array of image URLs/paths
                  example: ["assets/image/products/rice/rice.jpg"]
      responses:
        '201':
          description: Product created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductCreateResponse'
        '400':
          description: Bad request - Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '409':
          description: Conflict - Product with this key already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'

  /api/v1/docs/web/products/{product_id}:
    get:
      summary: Get a product by ID
      description: Retrieve a single product by its ID (protected endpoint)
      tags: [Web]
      parameters:
        - in: path
          name: product_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the product
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Product retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductSingleResponse'
        '400':
          description: Bad request - Invalid product ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '404':
          description: Product not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
    
    put:
      summary: Update a product
      description: Update an existing product by ID (protected endpoint). All fields are optional.
      tags: [Web]
      parameters:
        - in: path
          name: product_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the product
          example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                key:
                  type: string
                  description: Updated product key/identifier
                  example: "rice"
                category:
                  type: string
                  description: Updated product category name (must exist in categories)
                  example: "Export"
                product:
                  type: string
                  description: Updated product name
                  example: "Rice"
                caption:
                  type: string
                  description: Updated product caption/description
                  example: "Cambodia - France, Germany, Philippines and China"
                image:
                  type: array
                  items:
                    type: string
                  description: Updated array of image URLs/paths
                  example: ["assets/image/products/rice/rice.jpg"]
      responses:
        '200':
          description: Product updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductUpdateResponse'
        '400':
          description: Bad request - Invalid ID format, missing fields, or no fields to update
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '404':
          description: Product or category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '409':
          description: Conflict - Product with this key already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
    
    delete:
      summary: Delete a product
      description: Delete a product by ID (protected endpoint)
      tags: [Web]
      parameters:
        - in: path
          name: product_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the product
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Product deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductDeleteResponse'
        '400':
          description: Bad request - Invalid product ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '404':
          description: Product not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductErrorResponse'

  /api/v1/docs/seo:
    get:
      summary: Get all SEO entries
      description: Retrieve a list of all SEO entries from the database
      tags:
        - SEO
      responses:
        '200':
          description: List of SEO entries retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SEO'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    
    post:
      summary: Create a new SEO entry
      tags:
        - SEO
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SEO'
      responses:
        '201':
          description: SEO created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: SEO created
        '400':
          description: SEO for this page already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
                
  /api/v1/docs/seo/{page}:
    get:
      summary: Get SEO data for a page
      tags:
        - SEO
      parameters:
        - in: path
          name: page
          schema:
            type: string
          required: true
          description: Page identifier, e.g., "services"
        - in: query
          name: tab
          schema:
            type: string
          required: false
          description: Optional tab or subpage, e.g., "custom" or "land"
      responses:
        '200':
          description: SEO data retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SEO'
        '404':
          description: Page not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      summary: Update SEO data for a page
      tags:
        - SEO
      parameters:
        - in: path
          name: page
          schema:
            type: string
          required: true
          description: Page identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SEO'
      responses:
        '200':
          description: SEO updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: SEO updated
        '404':
          description: Page not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      summary: Delete SEO entry for a page
      tags:
        - SEO
      parameters:
        - in: path
          name: page
          schema:
            type: string
          required: true
          description: Page identifier
      responses:
        '200':
          description: SEO deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: SEO deleted
        '404':
          description: Page not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  
  /api/v1/price/health:
    get:
      summary: Health check
      tags: [System]
      responses:
        '200':
          description: API is running
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string

  /api/v1/price/quote:
    post:
      summary: Calculate logistics quote
      tags: [Quote]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - origin
                - destination
                - containerMaxWeight
                - containerQuantity
                - commodity
              properties:
                origin:
                  type: string
                  example: "Phnom Penh"
                destination:
                  type: string
                  example: "Siem Reap"
                containerMaxWeight:
                  type: number
                  example: 22000
                containerQuantity:
                  type: integer
                  example: 1
                containerSize:
                  type: string
                  example: "20' Dry"
                equipmentType:
                  type: string
                  example: "Dry Van"
                soc:
                  type: boolean
                  example: false
                commodity:
                  type: string
                  example: "Electronics"
                vesselDeparture:
                  type: string
                  example: "Vessel ABC123"
                departure_date:
                  type: string
                  format: date
                  example: "2025-12-30"
                mode:
                  type: string
                  example: "sea"
                country:
                  type: string
                  example: "KH"
                shipment_type:
                  type: string
                  example: "parcel"
      responses:
        '200':
          description: Quote calculated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuoteDocument'
        '400':
          description: Validation error
        '404':
          description: No rate available
        '500':
          description: Server error

  /api/v1/price/quote/{quote_id}:
    get:
    summary: Get quote by ID
    tags: [Quote]
    parameters:
      - in: path
        name: quote_id
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Quote found
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QuoteDocument'
      '404':
        description: Quote not found
      '500':
        description: Server error

  /api/v1/price/quotes/history:
    get:
    summary: Get quote history
    tags: [Quote]
    parameters:
      - in: query
        name: page
        schema:
          type: integer
          default: 1
      - in: query
        name: limit
        schema:
          type: integer
          default: 20
      - in: query
        name: origin
        schema:
          type: string
      - in: query
        name: destination
        schema:
          type: string
      - in: query
        name: start_date
        schema:
          type: string
          format: date
      - in: query
        name: end_date
        schema:
          type: string
          format: date
    responses:
      '200':
        description: Quote history list
        content:
          application/json:
            schema:
              type: object
              properties:
                quotes:
                  type: array
                  items:
                    $ref: '#/components/schemas/QuoteDocument'
                total:
                  type: integer
                page:
                  type: integer
                pages:
                  type: integer
      '500':
        description: Server error

  /api/v1/price/rate-cards:
    get:
      summary: Get active rate cards
      tags: [Rate Card]
      responses:
        '200':
          description: List of rate cards
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RateCard'

    post:
      summary: Create rate card (Admin)
      tags: [Rate Card]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateCardInput'
      responses:
        '201':
          description: Rate card created

  /api/v1/price/rate-cards/{card_id}:
    put:
      summary: Update rate card (Admin)
      tags: [Rate Card]
      parameters:
        - in: path
          name: card_id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Rate card updated
        '404':
          description: Rate card not found

    delete:
      summary: Deactivate rate card (Admin)
      tags: [Rate Card]
      parameters:
        - in: path
          name: card_id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Rate card deactivated

  /api/v1/price/finder_port/search:
    get:
      tags: [FinderPort]
      summary: Search ports worldwide (autocomplete)
      parameters:
        - name: q
          in: query
          description: Search query (min 2 characters)
          required: true
          schema:
            type: string
      responses:
        '200':
          description: List of matching ports
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Port'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/price/finder_port:
    get:
      tags: [FinderPort]
      summary: Get all ports
      responses:
        '200':
          description: List of all active ports
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Port'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    post:
      tags: [FinderPort]
      summary: Create a new port
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PortCreate'
      responses:
        '201':
          description: Port created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PortResponse'
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/price/finder_port/{port_id}:
    get:
      tags: [FinderPort]
      summary: Get port by ID
      parameters:
        - name: port_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Port details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PortResponse'
        '404':
          description: Port not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      tags: [FinderPort]
      summary: Update port by ID
      parameters:
        - name: port_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PortUpdate'
      responses:
        '200':
          description: Port updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '404':
          description: Port not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags: [FinderPort]
      summary: Delete (soft) port by ID
      parameters:
        - name: port_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Port deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '404':
          description: Port not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/price/commodities:
    get:
      summary: Get all commodities
      tags: [Commodities]
      responses:
        '200':
          description: List of commodities
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityErrorResponse'

    post:
      summary: Create a new commodity
      tags: [Commodities]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Commodity name
                  example: "Rice"
                description:
                  type: string
                  description: Optional description
                  example: "High-quality Cambodian rice"
                code:
                  type: string
                  description: HS code or commodity code
                  example: "10061000"
      responses:
        '201':
          description: Commodity created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityCreateResponse'
        '400':
          description: Bad request - Missing required fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityErrorResponse'
        '409':
          description: Conflict - Commodity with this name/code already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityErrorResponse'

  /api/v1/price/commodities/{commodity_id}:
    get:
      summary: Get a commodity by ID
      tags: [Commodities]
      parameters:
        - in: path
          name: commodity_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the commodity
      responses:
        '200':
          description: Commodity fetched successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommoditySingleResponse'
        '404':
          description: Commodity not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityErrorResponse'

    put:
      summary: Update a commodity
      tags: [Commodities]
      parameters:
        - in: path
          name: commodity_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the commodity
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Updated commodity name
                  example: "Rice"
                description:
                  type: string
                  description: Updated description
                  example: "Premium export rice"
                code:
                  type: string
                  description: Updated HS code
                  example: "10061000"
      responses:
        '200':
          description: Commodity updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityUpdateResponse'
        '404':
          description: Commodity not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityErrorResponse'

    delete:
      summary: Delete a commodity
      tags: [Commodities]
      parameters:
        - in: path
          name: commodity_id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the commodity
      responses:
        '200':
          description: Commodity deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityDeleteResponse'
        '404':
          description: Commodity not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommodityErrorResponse'
